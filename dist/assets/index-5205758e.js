import{a as V}from"./axios-78cd9fea.js";import{I as E}from"./vue-qrcode-reader-2a2e687e.js";import"./users-6c6e41da.js";import{_ as S}from"./_plugin-vue_export-helper-c27b6911.js";import{r as o,a as s,o as t,c,w as v,b as f,u as O,d as R,e as b,t as y,f as r,g,p as T,h as j}from"./index-6b729fcd.js";import{b as w}from"./route-block-83d24a4e.js";import"./apolloClient-3b54e56b.js";const Q=u=>(T("data-v-bbeea821"),u=u(),j(),u),$={key:0,class:"mb-4"},q=Q(()=>b("h3",null,"Scanned QR Code:",-1)),M={__name:"AuthVendors",setup(u){const k="https://huge-eagles-guess.loca.lt",n=o(""),p=o(""),i=o(""),a=o(!1),x=o(!1),d=o(""),m=o(!1),A=async _=>{n.value=_[0].rawValue,a.value=!0;try{const e=new URL(n.value),l=e.searchParams.get("accessToken"),h=await V.get(e.origin+e.pathname,{params:{accessToken:l}});p.value=h}catch(e){p.value=e}finally{}},N=async()=>{a.value=!0;try{const e=new URL(n.value).searchParams.get("code"),l=await V.post(`${k}/vendors/login`,{token:e},{params:{vendorPin:i.value}});l.data.success?(localStorage.setItem("vendorId",l.data.vendorId),localStorage.setItem("vendorPin",i.value),localStorage.setItem("userVendorRole","VENDOR"),m.value=!0,d.value="Authentication successful!"):(m.value=!1,d.value="Authentication failed!")}catch(_){console.error("Error during login:",_),m.value=!1,d.value="Authentication failed!"}finally{a.value=!1}};return(_,e)=>{const l=s("v-divider"),h=s("v-text-field"),P=s("v-icon"),L=s("v-btn"),I=s("v-alert"),U=s("v-progress-linear"),B=s("v-card");return t(),c(B,{class:"pa-4",outlined:""},{default:v(()=>[f(O(E),{style:{"max-height":"54vh"},onDetect:A}),f(l,{class:"my-4"}),n.value?(t(),R("div",$,[q,b("p",null,y(n.value),1),b("p",null,y(p.value),1)])):r("",!0),x.value?(t(),c(h,{key:1,label:"Enter PIN",type:"password",modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=D=>i.value=D),"prepend-icon":"mdi-lock",disabled:a.value},null,8,["modelValue","disabled"])):r("",!0),x.value?(t(),c(L,{key:2,color:"success",class:"mb-2",style:{color:"white"},"prepend-icon":"mdi-check-circle",onClick:N,variant:"outlined",loading:a.value,disabled:!i.value||a.value},{prepend:v(()=>[f(P,{color:"success"})]),default:v(()=>[g(" Login ")]),_:1},8,["loading","disabled"])):r("",!0),p.value==="invalid"?(t(),c(I,{key:3,type:"error",class:"mb-2",style:{color:"white"}},{default:v(()=>[g(" Invalid QR Code or URL ")]),_:1})):r("",!0),d.value.length>0?(t(),c(I,{key:4,type:m.value?"success":"error",class:"mb-2",style:{color:"white"}},{default:v(()=>[g(y(d.value),1)]),_:1},8,["type"])):r("",!0),a.value?(t(),c(U,{key:5,indeterminate:"",color:"primary",class:"my-4"})):r("",!0)]),_:1})}}},z=S(M,[["__scopeId","data-v-bbeea821"]]);const C={__name:"index",setup(u){return(k,n)=>(t(),R("div",null,[f(z)]))}};typeof w=="function"&&w(C);const Y=S(C,[["__scopeId","data-v-c557689f"]]);export{Y as default};
