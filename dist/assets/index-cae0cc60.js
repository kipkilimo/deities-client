import{b as pe}from"./browser-9d43139f.js";import{L as me}from"./PollPlayerAnalysis-37ded3df.js";import{u as fe}from"./resources-c352f549.js";import{r as y,i as ge,j as ye,k as he,l as be,m as ke,a,o as d,c as m,w as l,b as e,e as i,g as v,t as x,u as K,d as P,F as z,n as M,f as T,p as xe,h as Se}from"./index-29b1d87f.js";import{_ as we}from"./_plugin-vue_export-helper-c27b6911.js";import"./chart-d498817c.js";import"./apolloClient-3b54e56b.js";const U=S=>(xe("data-v-854a9cc7"),S=S(),Se(),S),Ce=["src"],Ie=U(()=>i("span",null,[i("img",{style:{"max-height":"1.5rem",cursor:"pointer","z-index":"-20"},class:"mt-4",src:"https://media.tenor.com/3I5SoxI-DiYAAAAi/live.gif"})],-1)),Ve={class:"ma-2"},qe=U(()=>i("h1",null,"Presenter",-1)),Ne={class:"font-weight-black-lighten-2 text-h4",style:{color:"#55565a","font-family":"Ubuntu"}},Re=U(()=>i("br",null,null,-1)),Pe={key:4,class:"text-center"},Ue=U(()=>i("br",null,null,-1)),Ae={__name:"PollPlayerPresenter",setup(S){const J="wss.nem.bio:4000",h=y(!1),w=y(!1),j="https://nem.bio",F=fe(),C=ge(),Y=ye(),_=C.query.accessKey,p=C.query.sessionId,A=y(""),$=y(""),o=y([]),n=y(0),E=y({qstId:""});let r;const G=async s=>{try{const t=await pe.toDataURL(s,{type:"png"});A.value=t}catch(t){console.error(t)}},H=()=>{r=new WebSocket(`${J}/ws`),r.onopen=()=>{r.send(JSON.stringify({type:"fetch_poll",accessKey:_,sessionId:p}))},r.onmessage=s=>{try{const t=JSON.parse(s.data);F.resource=t.resource,localStorage.setItem("pollResource",JSON.stringify(t.resource));const q=t.resource,b=JSON.parse(q.content).pollArray||[];o.value=b}catch(t){console.error("Error parsing JSON:",t)}},r.onerror=s=>{console.error("WebSocket error:",s)},r.onclose=()=>{r.send(JSON.stringify({type:"update_active_question",qstId:"",accessKey:_,sessionId:p}))}};function X(){r.close(),Y.push("/dashboard/overview"),setTimeout(()=>{window.location.reload()},900)}const Z=()=>{r.send(JSON.stringify({type:"update_active_question",qstId:"",accessKey:_,sessionId:p})),r.close(),console.log("WebSocket closed due to route change")};he(()=>C.path,s=>{s.includes("poll")||(r.send(JSON.stringify({type:"update_active_question",qstId:"",accessKey:_,sessionId:p})),Z())}),be(()=>{const s=`${j}/poll/participant?sessionId=${p}&accessKey=${_}`;$.value=s,G(s),H()}),ke(async()=>{r&&r.close()});const ee=async()=>{if(o.value.length&&n.value<o.value.length-1){n.value++;const s=o.value[n.value].qstId;s&&(E.value.qstId=s,console.log("Navigating to next question:",s),r.send(JSON.stringify({type:"update_active_question",qstId:s,accessKey:_,sessionId:p})))}},te=async()=>{if(o.value.length&&n.value>0){n.value--;const s=o.value[n.value].qstId;s&&(E.value.qstId=s,console.log("Navigating to previous question:",s),r.send(JSON.stringify({type:"update_active_question",qstId:s,accessKey:_,sessionId:p})))}};function le(){let s={type:"reset_all_responses",accessKey:_,sessionId:p};if(r.readyState===WebSocket.OPEN)try{r.send(JSON.stringify(s)),console.log("Message sent to WebSocket server.")}catch(t){console.error("Error sending WebSocket message:",t)}else console.error("WebSocket connection is not open. ReadyState:",r.readyState)}function oe(){return window.location.reload(),!0}return(s,t)=>{const q=a("v-card-title"),f=a("v-divider"),b=a("v-img"),Q=a("v-card-text"),I=a("v-spacer"),k=a("v-btn"),N=a("v-card-actions"),R=a("v-card"),W=a("v-dialog"),g=a("v-col"),ne=a("router-link"),O=a("v-row"),se=a("v-radio"),ae=a("v-radio-group"),re=a("v-checkbox"),ue=a("v-checkbox-group"),ce=a("v-select"),ie=a("v-textarea"),de=a("v-rating"),ve=a("v-card-subtitle"),_e=a("v-container");return d(),m(_e,{fluid:"","fill-height":""},{default:l(()=>[e(O,{align:"left",justify:"left"},{default:l(()=>[e(g,{cols:"9",class:"text-left mb-1"},{default:l(()=>[i("img",{style:{height:"12rem",cursor:"pointer"},src:A.value,alt:"QR Code",onClick:t[0]||(t[0]=c=>h.value=!0)},null,8,Ce),e(W,{"max-width":"720",modelValue:h.value,"onUpdate:modelValue":t[2]||(t[2]=c=>h.value=c),"onClick:outside":t[3]||(t[3]=c=>h.value=!1)},{default:l(()=>[e(R,{"min-width":"720"},{default:l(()=>[e(q,{class:"text-h5"},{default:l(()=>[v("Join a NEMBio "),Ie,v(" Poll")]),_:1}),e(f,{class:"ma-2"}),e(Q,null,{default:l(()=>[e(b,{src:A.value,alt:"QR Code"},null,8,["src"])]),_:1}),e(f,{class:"ma-2"}),i("p",Ve,x($.value),1),e(N,null,{default:l(()=>[e(I),e(k,{text:"",onClick:t[1]||(t[1]=c=>h.value=!1)},{default:l(()=>[v("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(g,{cols:"3",class:"text-left mb-4"},{default:l(()=>[e(ne,{to:"/dashboard/overview",class:"flex items-center"},{default:l(()=>[e(b,{src:"https://a2z-v0.s3.eu-central-1.amazonaws.com/Screenshot+from+2024-10-22+16-31-16.png",width:100,height:40})]),_:1}),i("div",null,[e(O,null,{default:l(()=>[e(g,{cols:"9"},{default:l(()=>[qe,i("p",null,"Poll ID: "+x(K(C).query.sessionId),1),i("p",null,"Access Key: "+x(K(C).query.accessKey),1)]),_:1}),e(g,{cols:"3"},{default:l(()=>[e(b,{style:{cursor:"pointer"},height:"3.6rem",onClick:X,src:"https://cdn11.bigcommerce.com/s-3pbmh1zmv/images/stencil/760x760/products/1822/2093/2694-label__65712.1691921739.png?c=1"})]),_:1})]),_:1})])]),_:1}),o.value.length>=1?(d(),m(g,{key:0,cols:"12"},{default:l(()=>[e(R,{"min-height":"75vh","max-height":"75vh"},{default:l(()=>[e(Q,null,{default:l(()=>{var c,V;return[i("span",Ne,[v(x((c=o.value[n.value])==null?void 0:c.type)+" | ",1),i("strong",null,x((V=o.value[n.value])==null?void 0:V.question),1)])]}),_:1}),e(f),Re,e(O,null,{default:l(()=>[e(g,{cols:"4"},{default:l(()=>[e(R,{flat:"",class:"custom-card d-flex flex-column",color:"transparent",tile:""},{default:l(()=>{var c,V,L,B,D;return[((c=o.value[n.value])==null?void 0:c.type)==="Single Choice"?(d(),m(ae,{key:0,modelValue:o.value[n.value].selectedAnswer,"onUpdate:modelValue":t[4]||(t[4]=u=>o.value[n.value].selectedAnswer=u)},{default:l(()=>[(d(!0),P(z,null,M(o.value[n.value].options,u=>(d(),m(se,{key:u,label:u,value:u},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):((V=o.value[n.value])==null?void 0:V.type)==="Multiple Choice"?(d(),m(ue,{key:1,modelValue:o.value[n.value].selectedAnswers,"onUpdate:modelValue":t[5]||(t[5]=u=>o.value[n.value].selectedAnswers=u)},{default:l(()=>[(d(!0),P(z,null,M(o.value[n.value].options,u=>(d(),m(re,{key:u,label:u,value:u},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):((L=o.value[n.value])==null?void 0:L.type)==="Ranking"?(d(),m(ce,{key:2,class:"ma-2",compact:"",modelValue:o.value[n.value].ranking,"onUpdate:modelValue":t[6]||(t[6]=u=>o.value[n.value].ranking=u),items:o.value[n.value].options,label:"Rank the options",multiple:""},null,8,["modelValue","items"])):((B=o.value[n.value])==null?void 0:B.type)==="Open-Ended"?(d(),m(ie,{key:3,modelValue:o.value[n.value].answer,"onUpdate:modelValue":t[7]||(t[7]=u=>o.value[n.value].answer=u),label:"Your response"},null,8,["modelValue"])):((D=o.value[n.value])==null?void 0:D.type)==="Rating"?(d(),P("div",Pe,[e(de,{modelValue:o.value[n.value].rating,"onUpdate:modelValue":t[8]||(t[8]=u=>o.value[n.value].rating=u),"half-increments":"",length:5,"background-color":"#00a7ff",hover:""},null,8,["modelValue"]),i("pre",null,x(o.value[n.value].rating),1)])):T("",!0),e(f,{class:"mt-auto"}),e(N,null,{default:l(()=>[e(I),e(k,{onClick:te,disabled:n.value===0,class:"ma-2"},{default:l(()=>[v(" Previous ")]),_:1},8,["disabled"]),e(k,{onClick:ee,disabled:n.value===o.value.length-1,class:"ma-2"},{default:l(()=>[v(" Next ")]),_:1},8,["disabled"]),e(I),e(b,{style:{cursor:"pointer"},height:"2.4rem",onClick:oe,src:"https://cdn-icons-png.flaticon.com/128/10619/10619786.png"})]),_:1})]}),_:1})]),_:1}),e(f,{vertical:""}),e(g,{cols:"6"},{default:l(()=>[e(me)]),_:1})]),_:1}),e(N,null,{default:l(()=>[e(k,{color:"deep-orange-lighten-2",text:"RESET ALL RESPONSES",rounded:"xs",border:"",style:{width:"32.8%"},onClick:t[9]||(t[9]=c=>w.value=!0)})]),_:1})]),_:1})]),_:1})):T("",!0)]),_:1}),e(W,{modelValue:w.value,"onUpdate:modelValue":t[12]||(t[12]=c=>w.value=c),width:"24rem"},{default:l(()=>[e(R,null,{default:l(()=>[e(q,{class:"text-h6"},{default:l(()=>[v("Clear all Responses?")]),_:1}),e(ve,null,{default:l(()=>[v(" This erases all previous participant inputs. ")]),_:1}),Ue,e(f),e(N,null,{default:l(()=>[e(I),e(k,{variant:"outlined",color:"orange",onClick:t[10]||(t[10]=c=>w.value=!1)},{default:l(()=>[v("Confirm and Clear")]),_:1}),e(I),e(k,{onClick:t[11]||(t[11]=c=>w.value=!1),color:"green"},{default:l(()=>[v("Cancel")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},Oe=we(Ae,[["__scopeId","data-v-854a9cc7"]]),De={__name:"index",setup(S){return(J,h)=>(d(),P("div",null,[e(Oe)]))}};export{De as default};
