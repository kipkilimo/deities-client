import{L as F}from"./PollPlayerAnalysis-37ded3df.js";import{u as T}from"./resources-c352f549.js";import{i as H,r as w,x as Y,z as $,m as G,a,o as d,c as p,w as o,b as l,e as u,t as v,u as R,g as q,d as C,F as X,n as Z,f as N,p as ee,h as te}from"./index-29b1d87f.js";import{_ as le}from"./_plugin-vue_export-helper-c27b6911.js";const b=f=>(ee("data-v-1ea5df5d"),f=f(),te(),f),ne=b(()=>u("img",{style:{width:"100%","max-height":"9rem","object-fit":"cover"},src:"https://www.vevox.com/getmedia/d6e9e7d0-b98a-455b-b404-da9687ffd488/Live-polling_Hero_1166x523.png?width=1107",alt:"Live Poll"},null,-1)),oe={class:"mt-3"},se=b(()=>u("h1",{class:"text-h6"},"Participant",-1)),ae={class:"font-weight-black-lighten-2 text-h4",style:{color:"#55565a","font-family":"Ubuntu"}},re=b(()=>u("br",null,null,-1)),ce=b(()=>u("br",null,null,-1)),ie={key:4,class:"text-center"},ue=5,de={__name:"PollPlayerParticipant",setup(f){const g=H(),O="wss.nem.bio:4000",U=w(!0),s=w({type:null,question:"",options:[],qstId:null}),t=w({selectedAnswer:null,selectedAnswers:[],ranking:[],answer:"",rating:null}),W=T(),x=g.query.accessKey,V=g.query.sessionId;let c,y=0;const E=Y(()=>{var e;const n=s.value;return n.type==="Single Choice"?!!t.value.selectedAnswer:n.type==="Multiple Choice"?!!t.value.selectedAnswers:n.type==="Ranking"?((e=t.value.ranking)==null?void 0:e.length)===n.options.length:n.type==="Open-Ended"?!!t.value.answer:n.type==="Rating"?!!t.value.rating:!1});function M(){return window.location.reload(),!0}const A=()=>{c=new WebSocket(`${O}/ws`),c.onopen=()=>{c.send(JSON.stringify({type:"fetch_poll",accessKey:x,sessionId:V})),y=0},c.onmessage=n=>{try{const e=JSON.parse(n.data);W.resource=e.resource,localStorage.setItem("pollResource",JSON.stringify(e.resource));const i=e.resource,_=JSON.parse(i.content),k=_.pollArray||[],m=_.activeQuestion.qstId,S=k.find(h=>h.qstId===m);s.value=S}catch(e){console.error("Error parsing JSON:",e)}},c.onerror=n=>{console.error("WebSocket error:",n)},c.onclose=()=>{console.log("WebSocket connection closed"),y<ue?setTimeout(()=>{y++,A()},Math.pow(2,y)*1e3):console.error("Max reconnect attempts reached.")}};$(()=>{A()}),G(()=>{c&&c.close()});const B=async()=>{const n=s.value;if(!n)return;let e={type:"submit_response_event",qstId:n.qstId,accessKey:x,sessionId:V};if(n.type==="Multiple Choice"?e.selectedAnswers=t.value.selectedAnswers:n.type==="Single Choice"?e.selectedAnswer=t.value.selectedAnswer:n.type==="Ranking"?e.ranking=t.value.ranking:n.type==="Open-Ended"?e.answer=t.value.answer:n.type==="Rating"&&(e.rating=t.value.rating),c.readyState===WebSocket.OPEN)try{c.send(JSON.stringify(e)),console.log("Message sent to WebSocket server.")}catch(i){console.error("Error sending WebSocket message:",i)}else console.error("WebSocket connection is not open. ReadyState:",c.readyState);t.value=w({selectedAnswer:null,selectedAnswers:[],ranking:[],answer:"",rating:null})};return(n,e)=>{const i=a("v-col"),_=a("v-img"),k=a("router-link"),m=a("v-row"),S=a("v-card-text"),h=a("v-divider"),J=a("v-radio"),L=a("v-radio-group"),P=a("v-select"),z=a("v-textarea"),K=a("v-rating"),Q=a("v-btn"),j=a("v-card-actions"),I=a("v-card"),D=a("v-container");return d(),p(D,{fluid:"","fill-height":""},{default:o(()=>[l(m,null,{default:o(()=>[l(i,{cols:"12",sm:"9",class:"text-left mb-4"},{default:o(()=>[ne]),_:1}),l(i,{cols:"12",sm:"3",class:"text-left mb-4"},{default:o(()=>[l(k,{to:"/dashboard/overview",class:"d-flex align-center"},{default:o(()=>[l(_,{src:"https://a2z-v0.s3.eu-central-1.amazonaws.com/Screenshot+from+2024-10-22+16-31-16.png",width:"100",height:"40"})]),_:1}),u("div",oe,[l(m,null,{default:o(()=>[l(i,{cols:"9"},{default:o(()=>[se,u("p",null,"Poll ID: "+v(R(g).query.sessionId),1),u("p",null,"Access Key: "+v(R(g).query.accessKey),1)]),_:1}),l(i,{cols:"3"},{default:o(()=>[l(_,{style:{cursor:"pointer"},onClick:M,height:"3rem",src:"https://cdn-icons-png.flaticon.com/128/10619/10619786.png"})]),_:1})]),_:1})])]),_:1})]),_:1}),U.value&&s.value&&s.value.question?(d(),p(I,{key:0,style:{height:"78vh"},class:"pa-4"},{default:o(()=>[l(S,null,{default:o(()=>[u("span",ae,[q(v(s.value.type)+" | ",1),u("strong",null,v(s.value.question),1)])]),_:1}),l(h),re,l(m,null,{default:o(()=>[l(i,{cols:"12",sm:"5"},{default:o(()=>[l(I,{height:"75vh",flat:"",color:"transparent"},{default:o(()=>[ce,s.value.type==="Single Choice"?(d(),p(L,{key:0,modelValue:t.value.selectedAnswer,"onUpdate:modelValue":e[0]||(e[0]=r=>t.value.selectedAnswer=r),class:"ml-4"},{default:o(()=>[(d(!0),C(X,null,Z(s.value.options,r=>(d(),p(J,{key:r,label:r,value:r},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):s.value.type==="Multiple Choice"?(d(),p(P,{key:1,modelValue:t.value.selectedAnswers,"onUpdate:modelValue":e[1]||(e[1]=r=>t.value.selectedAnswers=r),items:s.value.options,multiple:"",label:"Select multiple options",class:"ml-4"},null,8,["modelValue","items"])):s.value.type==="Ranking"?(d(),p(P,{key:2,modelValue:t.value.ranking,"onUpdate:modelValue":e[2]||(e[2]=r=>t.value.ranking=r),items:s.value.options,multiple:"","item-value":"value","item-text":"label",class:"ml-4",label:"Rank options"},null,8,["modelValue","items"])):s.value.type==="Open-Ended"?(d(),p(z,{key:3,modelValue:t.value.answer,"onUpdate:modelValue":e[3]||(e[3]=r=>t.value.answer=r),class:"ml-4",label:"Your answer",rows:"3"},null,8,["modelValue"])):s.value.type==="Rating"?(d(),C("div",ie,[l(K,{modelValue:t.value.rating,"onUpdate:modelValue":e[4]||(e[4]=r=>t.value.rating=r),"half-increments":"",class:"ml-4",length:5,max:"5",icon:"mdi-star","background-color":"#00a7ff",hover:""},null,8,["modelValue"]),u("pre",null,v(t.value.rating),1)])):N("",!0),l(j,null,{default:o(()=>[l(Q,{onClick:B,disabled:!E.value,class:"ma-2"},{default:o(()=>[q(" Submit ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),l(h,{class:"d-none d-sm-block",vertical:"","min-height":"76vh"}),l(i,{cols:"6",class:"justify-center align-center ml-28"},{default:o(()=>[l(F)]),_:1})]),_:1})]),_:1})):N("",!0)]),_:1})}}},fe=le(de,[["__scopeId","data-v-1ea5df5d"]]);export{fe as P};
