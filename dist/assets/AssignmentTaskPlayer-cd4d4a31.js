import{_ as le}from"./style.css_vue_type_style_index_0_src_true_lang-b904ba3d.js";import{u as re}from"./resources-c352f549.js";import{V as ie}from"./vue3-pdf-app.umd-5c7002a6.js";import{T as ue}from"./TaskResponseFileUploader-09e529a5.js";import{a as de}from"./axios-78cd9fea.js";import{_ as ce}from"./_plugin-vue_export-helper-c27b6911.js";import{r as c,x as pe,l as me,s as ve,a as i,o as l,c as S,w as t,b as e,u as _e,f as u,g as m,e as r,t as d,d as f,v as N,p as fe,h as ye}from"./index-29b1d87f.js";const T=D=>(fe("data-v-99f43851"),D=D(),ye(),D),ge=T(()=>r("h3",null,"Assignment Task",-1)),ke=T(()=>r("h3",null,"Answer Key",-1)),Te={class:"ma-1"},he=T(()=>r("br",null,null,-1)),we={key:0},Se={key:1},De={key:2},Ie={key:3},Ve={key:4},xe={class:"font-weight-black"},Ae={class:"ma-4"},Ee={class:"text-overline ml-4"},Me={key:0},Ue={key:1},be={key:2},Ne={key:3},Oe={key:4},Pe=T(()=>r("span",null,"Only one response will be saved. Typed response will be dropped.",-1)),Ce=T(()=>r("span",null,"Only one response will be saved.Uploaded response will be dropped.",-1)),Re=T(()=>r("span",null,"Exit response editor",-1)),$e={__name:"AssignmentTaskPlayer",setup(D){const J="https://nem.bio:4000",O=re().resource,I=c(!1),V=c("Wipe and type your response ..."),x=c(!1),h=c(!1),L=c(localStorage.getItem("sessionId")),G=c(O.sessionId),H=c(0),q=c(!1),P=c(null),A=c(null),{assignmentMetaInfo:W,assignmentAnswersKey:j,assignmentTaskSet:X}=JSON.parse(O.content),w=JSON.parse(W),v=c({assignmentType:w.assignmentType,assignmentTitle:w.assignmentTitle,assignmentDescription:w.assignmentDescription,assignmentDuration:w.assignmentDuration,assignmentDeadline:w.assignmentDeadline,assignmentAnswersKey:JSON.parse(j)[0],assignmentTaskSet:JSON.parse(X)[0]}),C=c(0);function R(p){const s=p.match(/GMT([+-]\d+)/);let k=0;s&&s[1]&&(k=parseInt(s[1],10),C.value=k);const y=p.replace(/(Friday|Saturday|Sunday|Monday|Tuesday|Wednesday|Thursday),?\s*/,"").replace(/ at /," ").replace(/GMT/,"GMT"),o=new Date(y);if(isNaN(o.getTime()))return null;const _=o.getTime(),g=k*60*60*1e3;return _-g}const Q=v.value.assignmentDeadline;R(Q);const $=R(v.value.assignmentDeadline);pe(()=>$>Date.now());const n=c({days:0,hours:0,minutes:0,seconds:0}),z=()=>{const p=Date.now(),s=$-p+1e3*60*60*C.value;s>0?n.value={days:Math.floor(s/(1e3*60*60*24)),hours:Math.floor(s/(1e3*60*60)%24),minutes:Math.floor(s/(1e3*60)%60),seconds:Math.floor(s/1e3%60)}:n.value={days:0,hours:0,minutes:0,seconds:0}};let K;me(()=>{z(),K=setInterval(z,1e3),E(v.value.assignmentTaskSet)}),ve(()=>{clearInterval(K)});const E=p=>{A.value=p},Y=p=>{alert("Error loading PDF. Please try again later.")};async function Z(){const p=JSON.stringify({questionType:"TASK_TEXT",questionResponse:V.value,savedDate:Date.now()}),s=`${J}/resources/uploads/task/response?userId=${encodeURIComponent(L.value)}&sessionId=${encodeURIComponent(G.value)}`;try{await de.post(s,p,{headers:{"Content-Type":"application/json"}}),success.value="Assignment updated successfully.",setTimeout(()=>{window.location.reload()},4200)}catch{errorMessage.value="Error updating task:"}}return(p,s)=>{const k=i("v-col"),y=i("v-divider"),o=i("v-spacer"),_=i("v-btn"),g=i("v-card-actions"),ee=i("v-row"),se=i("v-card-text"),te=i("v-card-title"),M=i("v-card"),U=i("v-dialog"),ne=le,b=i("v-tooltip"),F=i("v-alert"),oe=i("v-progress-linear"),ae=i("v-container");return l(),S(ae,null,{default:t(()=>[e(ee,null,{default:t(()=>[A.value?(l(),S(k,{key:0,cols:"10",class:"pdf-container"},{default:t(()=>[e(_e(ie),{class:"pdf-viewer",pdf:A.value,zoom:130,onOpen:p.openHandler,onError:Y},null,8,["pdf","onOpen"])]),_:1})):u("",!0),e(k,{cols:"2"},{default:t(()=>[ge,e(y),e(g,null,{default:t(()=>[e(o),e(_,{size:"small",variant:"outlined",class:"action-button",onClick:s[0]||(s[0]=a=>E(v.value.assignmentTaskSet)),color:"primary"},{default:t(()=>[m(" View Task PDF ")]),_:1}),e(o)]),_:1}),ke,e(g,null,{default:t(()=>[e(o),e(_,{disabled:n.value.days>0||n.value.hours>0||n.value.minutes>0||n.value.seconds>0,onClick:s[1]||(s[1]=a=>E(v.value.assignmentAnswersKey)),color:"primary"},{default:t(()=>[m(" View Answer Key ")]),_:1},8,["disabled"]),e(o)]),_:1}),r("p",null,"Type: "+d(v.value.assignmentType),1),r("div",Te,[r("p",null,"Deadline: "+d(v.value.assignmentDeadline),1),r("p",null,[m(" Answer reveals in:"),he,r("strong",null,[n.value.days>0?(l(),f("span",we,d(n.value.days)+"d ",1)):u("",!0),n.value.hours>0?(l(),f("span",Se,d(n.value.hours)+"h ",1)):u("",!0),n.value.minutes>0?(l(),f("span",De,d(n.value.minutes)+"m ",1)):u("",!0),n.value.seconds>0?(l(),f("span",Ie,d(n.value.seconds)+"s",1)):u("",!0),n.value.days>0||n.value.hours>0||n.value.minutes>0||n.value.seconds>0?u("",!0):(l(),f("span",Ve,"Lapsed"))])])]),e(y),e(g,null,{default:t(()=>[e(o),e(_,{class:"ms-2",size:"small",color:"success",disabled:"",text:"SUBMIT TASK RESPONSE",variant:"outlined",onClick:s[2]||(s[2]=a=>h.value=!0)}),e(o)]),_:1}),e(y),e(g,null,{default:t(()=>[e(o),e(_,{onClick:s[3]||(s[3]=a=>I.value=!0),color:"primary",size:"small"},{default:t(()=>[m(" View task details ")]),_:1}),e(o)]),_:1})]),_:1})]),_:1}),e(U,{modelValue:I.value,"onUpdate:modelValue":s[5]||(s[5]=a=>I.value=a),width:"630"},{default:t(()=>[e(M,{class:"mx-auto","prepend-icon":"mdi-note-edit-outline",width:"630"},{title:t(()=>[r("span",xe,d(v.value.assignmentTitle),1)]),default:t(()=>[e(se,{class:"bg-surface-light pt-4"},{default:t(()=>[m(d(v.value.assignmentDescription),1)]),_:1}),e(y),r("div",Ae,[r("p",Ee," Deadline: "+d(v.value.assignmentDeadline),1),e(te,{color:"grey"},{default:t(()=>[m(" Answer reveals in: "),r("strong",null,[n.value.days>0?(l(),f("span",Me,d(n.value.days)+"d ",1)):u("",!0),n.value.hours>0?(l(),f("span",Ue,d(n.value.hours)+"h ",1)):u("",!0),n.value.minutes>0?(l(),f("span",be,d(n.value.minutes)+"m ",1)):u("",!0),n.value.seconds>0?(l(),f("span",Ne,d(n.value.seconds)+"s",1)):u("",!0),n.value.days>0||n.value.hours>0||n.value.minutes>0||n.value.seconds>0?u("",!0):(l(),f("span",Oe,"Lapsed"))])]),_:1})]),e(y),e(g,null,{default:t(()=>[e(o),e(_,{class:"ms-2",size:"small",color:"success",disabled:"",text:"SUBMIT TASK RESPONSE",variant:"outlined",onClick:s[4]||(s[4]=a=>h.value=!0)}),e(o)]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(U,{modelValue:h.value,"onUpdate:modelValue":s[11]||(s[11]=a=>h.value=a),"max-width":"85%",persistent:""},{default:t(()=>[e(M,null,{default:t(()=>[e(ne,{modelValue:V.value,"onUpdate:modelValue":s[6]||(s[6]=a=>V.value=a)},null,8,["modelValue"]),e(y),e(g,null,{default:t(()=>[e(o),e(o),e(b,{location:"top"},{activator:t(({props:a})=>[e(_,N(a,{width:"18rem",color:"primary",variant:"outlined","prepend-icon":"mdi-cloud-upload-outline",onClick:s[7]||(s[7]=B=>x.value=!0)}),{default:t(()=>[m("UPLOAD A FILE RESPONSE")]),_:2},1040)]),default:t(()=>[Pe]),_:1}),e(o),e(b,{location:"top"},{activator:t(({props:a})=>[e(_,N(a,{width:"18rem",color:"primary","prepend-icon":"mdi-text-box-edit-outline",variant:"outlined",onClick:s[8]||(s[8]=B=>Z())}),{default:t(()=>[m("SAVE ASSIGNMENT RESPONSE")]),_:2},1040)]),default:t(()=>[Ce]),_:1}),e(o),e(o),e(o),m(),e(o),e(b,{location:"top"},{activator:t(({props:a})=>[e(_,N(a,{color:"error",icon:"mdi-location-exit",size:"x-large",onClick:s[9]||(s[9]=B=>h.value=!1)}),null,16)]),default:t(()=>[Re]),_:1})]),_:1})]),_:1}),e(U,{modelValue:x.value,"onUpdate:modelValue":s[10]||(s[10]=a=>x.value=a),"max-width":"24%"},{default:t(()=>[e(M,null,{default:t(()=>[e(ue)]),_:1})]),_:1},8,["modelValue"]),P.value?(l(),S(F,{key:0,type:"error",class:"mt-4"},{default:t(()=>[m(d(P.value),1)]),_:1})):u("",!0),p.uploading?(l(),S(oe,{key:1,value:H.value,height:"6",color:"green darken-2",class:"mt-4"},null,8,["value"])):u("",!0),q.value?(l(),S(F,{key:2,type:"success",class:"mt-4 custom-alert",text:""},{default:t(()=>[m(" Files uploaded successfully! ")]),_:1})):u("",!0)]),_:1},8,["modelValue"])]),_:1})}}},qe=ce($e,[["__scopeId","data-v-99f43851"]]);export{qe as T};
