import{A as W,j as X,r as p,y as S,a as u,o as x,c as V,w as o,d as Y,b as a,f as I,M as Z,e as f,g as _,s as Q,t as M,p as ee,h as te}from"./index-6b729fcd.js";import{u as oe,a as P}from"./users-6c6e41da.js";import{b as B}from"./route-block-83d24a4e.js";import{_ as ae}from"./_plugin-vue_export-helper-c27b6911.js";import"./apolloClient-3b54e56b.js";const A=y=>(ee("data-v-36adb934"),y=y(),te(),y),re={key:0},ne=A(()=>f("h3",{class:"mt-4 mr-11 ml-2",style:{color:"#777777"}}," NEMBio Learning Login ",-1)),se={class:"d-flex justify-space-between mt-4"},le=A(()=>f("span",null," Create an account",-1)),ie=A(()=>f("span",null,"Forgot Password?",-1)),ue=A(()=>f("span",null,"Signin with your ORCID",-1)),N=W({__name:"login",setup(y){const c=X(),i=oe(),h=p(!0),d=p(""),m=p(""),b=p(""),v=p(!1),s=p(""),g=p(!1),T=()=>{g.value=!g.value};function q(){c.push("/welcome")}const w=S(()=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.value)),G=S(()=>m.value.length>=6||b.value.length>=6),R=S(()=>w.value&&G.value),U=async()=>{if(d.value==="")return!1;v.value=!0;try{if(await i.singleSignInRequest(d.value),i.user.personalInfo.activatedAccount===!1){c.push("/auth/activate");return}h.value=!1,v.value=!1}catch(e){let r=function(t){return typeof t=="object"&&t!==null&&"graphQLErrors"in t&&Array.isArray(t.graphQLErrors)};s.value="Check your credentials.";let n=s.value;r(e)?e.graphQLErrors.length>0&&(n=e.graphQLErrors[0].message):e instanceof Error&&e.message&&(n=e.message),s.value=n,setTimeout(()=>{window.location.reload()},8100)}};function z(){if(h.value===!0){F();return}K()}const K=async()=>{v.value=!0;try{if(await i.singleSigninLogin(b.value),i.user.personalInfo.activatedAccount===!1){c.push("/auth/activate");return}const e=i.token,r=new Date;r.setDate(r.getDate()+7),P.set("authToken",e,{expires:r}),c.push("/dashboard/library")}catch(e){let r=function(t){return typeof t=="object"&&t!==null&&"graphQLErrors"in t&&Array.isArray(t.graphQLErrors)};s.value="Check your credentials.";let n=s.value;r(e)?e.graphQLErrors.length>0&&(n=e.graphQLErrors[0].message):e instanceof Error&&e.message&&(n=e.message),s.value=n,setTimeout(()=>{window.location.reload()},42e4)}},O=async()=>{v.value=!0;try{if(await i.login(d.value,m.value),i.user.personalInfo.activatedAccount===!1){c.push("/auth/activate");return}const e=i.token;P.set("authToken",e,{expires:7}),c.push("/dashboard/library")}catch(e){let r=function(t){return typeof t=="object"&&t!==null&&"graphQLErrors"in t&&Array.isArray(t.graphQLErrors)};s.value="Check your credentials.";let n=s.value;r(e)?e.graphQLErrors.length>0&&(n=e.graphQLErrors[0].message):e instanceof Error&&e.message&&(n=e.message),s.value=n,setTimeout(()=>{window.location.reload()},42e4)}},F=async()=>{v.value=!0;try{if(await i.login(d.value,m.value),i.user.personalInfo.activatedAccount===!1){c.push("/auth/activate");return}const e=i.token;P.set("authToken",e,{expires:7}),c.push("/dashboard/library")}catch(e){let r=function(t){return typeof t=="object"&&t!==null&&"graphQLErrors"in t&&Array.isArray(t.graphQLErrors)};s.value="Check your credentials.";let n=s.value;r(e)?e.graphQLErrors.length>0&&(n=e.graphQLErrors[0].message):e instanceof Error&&e.message&&(n=e.message),s.value=n,setTimeout(()=>{window.location.reload()},42e4)}};return(e,r)=>{const n=u("v-alert"),t=u("v-divider"),j=u("v-img"),H=u("v-card-title"),C=u("v-text-field"),L=u("v-icon"),E=u("v-btn"),k=u("v-tooltip"),D=u("v-card"),$=u("v-form"),J=u("v-card-text");return x(),V(D,{class:"login-card mt-4 ml-2",elevation:"4",outlined:"",rounded:""},{default:o(()=>[s.value?(x(),Y("div",re,[a(n,{text:s.value,title:"Login error",type:"error"},null,8,["text"])])):I("",!0),ne,a(t),a(H,{class:"text-center mb-2"},{default:o(()=>[a(j,{onClick:q,style:{height:"12rem",cursor:"pointer"},src:"https://a2z-v0.s3.eu-central-1.amazonaws.com/Screenshot+from+2024-10-22+16-31-16.png"})]),_:1}),a(J,null,{default:o(()=>[a($,{onSubmit:Z(z,["prevent"])},{default:o(()=>[a(C,{variant:"outlined",color:"primary",modelValue:d.value,"onUpdate:modelValue":r[0]||(r[0]=l=>d.value=l),label:"Registration email",required:"",autofocus:"","append-inner-icon":"mdi-email-lock-outline"},null,8,["modelValue"]),h.value?(x(),V(C,{key:0,variant:"outlined",modelValue:m.value,"onUpdate:modelValue":r[1]||(r[1]=l=>m.value=l),type:g.value?"text":"password",label:"Password","append-inner-icon":g.value?"mdi-eye-off-outline":"mdi-eye-outline","onClick:appendInner":T,required:""},null,8,["modelValue","type","append-inner-icon"])):I("",!0),h.value?I("",!0):(x(),V(C,{key:1,variant:"outlined",modelValue:b.value,"onUpdate:modelValue":r[2]||(r[2]=l=>b.value=l),type:g.value?"text":"password",label:"Access Pin",hint:"Enter access pin emailed to you.","append-inner-icon":g.value?"mdi-eye-off-outline":"mdi-eye-outline","onClick:appendInner":T,required:""},null,8,["modelValue","type","append-inner-icon"])),f("div",se,[a(E,{disabled:!R.value,style:{width:"12rem"},type:"submit",color:"primary",loading:v.value},{default:o(()=>[a(L,{class:"mr-sm"},{default:o(()=>[_("mdi-location-enter")]),_:1}),_(" Login ")]),_:1},8,["disabled","loading"]),a(k,{location:"top"},{activator:o(({props:l})=>[a(E,Q({disabled:!h.value||m.value.length>=6,color:w.value?"green":"primary",icon:"",height:"30",variant:"outlined"},l,{onClick:U}),{default:o(()=>[a(L,null,{default:o(()=>[_(M(w.value?"mdi-send-variant-clock-outline":"mdi-cloud-key-outline"),1)]),_:1})]),_:2},1040,["disabled","color"])]),default:o(()=>[f("span",null,M(w.value?"Submit and get access pin in your mailbox":"Provide the registration email to use a single signin pin"),1)]),_:1}),a(k,{location:"top"},{activator:o(({props:l})=>[a(E,Q(l,{color:"primary",icon:"",height:"30",variant:"outlined",to:"/auth/register"}),{default:o(()=>[a(L,null,{default:o(()=>[_("mdi-account-plus")]),_:1})]),_:2},1040)]),default:o(()=>[le]),_:1}),a(k,{location:"top"},{activator:o(({props:l})=>[a(E,Q({color:"cyan",icon:"",height:"30",variant:"outlined"},l,{to:"/auth/forgot"}),{default:o(()=>[a(L,null,{default:o(()=>[_("mdi-head-lightbulb")]),_:1})]),_:2},1040)]),default:o(()=>[ie]),_:1})]),a(D,{class:"mt-4",disabled:"",style:{width:"100%",cursor:"pointer","border-radius":"5px",border:"1px solid #bfbfbf"}},{default:o(()=>[a(k,{location:"bottom"},{activator:o(({props:l})=>[a(j,Q(l,{onClick:O,src:"https://blog.noyam.org/wp-content/uploads/2021/02/noyamblog17.jpg",style:{height:"4.5rem",cursor:"pointer"}}),null,16)]),default:o(()=>[ue]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}});typeof B=="function"&&B(N);const ge=ae(N,[["__scopeId","data-v-36adb934"]]);export{ge as default};
